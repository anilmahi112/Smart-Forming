<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üöú Vehicle Control ‚Äì Smart Farming</title>
<style>
body {
  font-family: "Poppins", sans-serif;
  background: linear-gradient(135deg, #c3f0ca, #8de88f);
  text-align: center;
  margin: 0;
  color: #0b3d1f;
}

header {
  background: #2e7d32;
  color: white;
  padding: 15px;
  font-size: 24px;
  font-weight: 700;
  text-shadow: 1px 1px 3px rgba(0,0,0,0.2);
}

.container {padding: 30px;}

/* Control buttons */
button {
  padding: 15px 25px;
  margin: 10px;
  border: none;
  border-radius: 10px;
  color: white;
  font-size: 18px;
  font-weight: 600;
  cursor: pointer;
  transition: 0.3s;
}
.forward {background: linear-gradient(90deg, #4caf50, #2e7d32);}
.reverse {background: linear-gradient(90deg, #4caf50, #2e7d32);}
.left, .right {background: linear-gradient(90deg, #2e7d32, #2e7d32);}
.stop {background: linear-gradient(90deg, #2e7d32, #2e7d32);}
.horn {background: linear-gradient(90deg, #2e7d32, #2e7d32);}
.light {background: linear-gradient(90deg, #2e7d32, #2e7d32);}
button:hover {opacity: 0.85; transform: scale(1.03);}

/* Servo section */
.servo-section {
  background: rgba(255,255,255,0.9);
  border-radius: 15px;
  padding: 20px;
  width: 280px;
  margin: 25px auto;
  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}
input[type=range]{width: 240px; accent-color: #2e7d32;}
.angle-display {margin-top: 6px; font-weight: 600;}

/* Info cards */
.info-section {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 18px;
  margin-top: 25px;
}
.info-card {
  background: rgba(255,255,255,0.93);
  box-shadow: 0 5px 15px rgba(0,0,0,0.15);
  border-radius: 12px;
  width: 180px;
  padding: 15px;
  text-align: center;
  font-weight: 600;
  transition: 0.3s;
}
.info-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 20px rgba(46,125,50,0.3);
}
.info-title {
  font-size: 15px;
  color: #1b5e20;
}
.info-value {
  font-size: 20px;
  margin-top: 6px;
  color: #0b3d1f;
}

/* Bottom button group */
.bottom-buttons {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-top: 40px;
}
.refresh-btn, .back-btn {
  padding: 12px 28px;
  border: none;
  border-radius: 10px;
  font-size: 17px;
  font-weight: 600;
  color: white;
  cursor: pointer;
  transition: 0.3s;
  box-shadow: 0 5px 12px rgba(0,0,0,0.2);
}
.refresh-btn {
  background: linear-gradient(90deg, #27ae60, #2ecc71);
}
.back-btn {
  background: linear-gradient(90deg, #607d8b, #455a64);
}
.refresh-btn:hover, .back-btn:hover {
  transform: scale(1.05);
  opacity: 0.95;
}

/* Responsive */
@media (max-width: 768px) {
  .info-section {flex-direction: column; align-items: center;}
  .info-card {width: 80%;}
  .bottom-buttons {flex-direction: column; gap: 15px;}
}
</style>
</head>
<body>
<header>Vehicle Control Panel</header>
<div class="container">

  <!-- Vehicle Direction Control -->
  <button class="forward" onclick="command('Forward')">Forward</button><br>
  <button class="left" onclick="command('Left')">Left</button>
  <button class="stop" onclick="command('Stop')">Stop</button>
  <button class="right" onclick="command('Right')">Right</button><br>
  <button class="reverse" onclick="command('Reverse')">Reverse</button><br>
  <button class="horn" onclick="command('Horn')">Horn</button>
  <button class="light" onclick="command('Light')">Light</button>

  <!-- Servo Control -->
  <div class="servo-section">
    <label>Servo 1 Angle (0¬∞‚Äì180¬∞)</label><br>
    <input type="range" id="servo1" min="0" max="180" value="180" oninput="updateServo(this.value)">
    <div class="angle-display" id="servo1Text">Angle: 180¬∞</div>
  </div>

  <!-- Vehicle Telemetry Info -->
  <div class="info-section">
    <div class="info-card">
      <div class="info-title">Distance of Obstacle 1</div>
      <div class="info-value" id="dist1Val">-- cm</div>
    </div>
    <div class="info-card">
      <div class="info-title">Distance of Obstacle 2</div>
      <div class="info-value" id="dist2Val">-- cm</div>
    </div>
    <div class="info-card">
      <div class="info-title">Tilt Angle</div>
      <div class="info-value" id="tiltVal">--¬∞</div>
    </div>
    <div class="info-card">
      <div class="info-title">Vehicle Condition</div>
      <div class="info-value" id="condVal">--</div>
    </div>
    <div class="info-card">
      <div class="info-title">Battery Level</div>
      <div class="info-value" id="batteryVal">--%</div>
    </div>
  </div>

  <!-- Refresh + Dashboard Buttons -->
  <div class="bottom-buttons">
    <button class="refresh-btn" onclick="manualRefresh()">Refresh</button>
    <button class="back-btn" onclick="goBack()">Dashboard</button>
  </div>
</div>

<script>
let currentCommand = "Stop";

function command(cmd){
  console.log("Command:", cmd);
  currentCommand = cmd;
  updateCondition();
}

function updateServo(val){
  document.getElementById("servo1Text").textContent = "Angle: " + val + "¬∞";
}

// Simulate telemetry updates
function updateTelemetry(){
  const dist1 = (20 + Math.random() * 80).toFixed(0);
  const dist2 = (25 + Math.random() * 75).toFixed(0);
  const tilt = (Math.random() * 10 - 5).toFixed(1);
  const battery = (70 + Math.random() * 30).toFixed(0);

  document.getElementById("dist1Val").textContent = dist1 + " cm";
  document.getElementById("dist2Val").textContent = dist2 + " cm";
  document.getElementById("tiltVal").textContent = tilt + "¬∞";
  document.getElementById("batteryVal").textContent = battery + "%";

  updateCondition(dist1, dist2);
}

function updateCondition(dist1 = 50, dist2 = 50){
  let cond = "";
  if (dist1 < 20 || dist2 < 20) cond = "Obstacle Very Close";
  else if (dist1 < 40 || dist2 < 40) cond = "Near Obstacle";
  else {
    switch(currentCommand){
      case "Forward": cond = "Moving Forward"; break;
      case "Reverse": cond = "Moving Backward"; break;
      case "Left": cond = "Turning Left"; break;
      case "Right": cond = "Turning Right"; break;
      case "Stop": cond = "Stopped"; break;
      default: cond = "Ready";
    }
  }
  document.getElementById("condVal").textContent = cond;
}

function manualRefresh(){
  updateTelemetry();
}

setInterval(updateTelemetry, 2000);

function goBack(){
  // ‚úÖ Smart safety check (prevents ‚ÄúCannot GET‚Äù error)
  fetch("dashboard.html")
    .then(res => {
      if (res.ok) window.location.href = "dashboard.html";
      else alert("‚ö†Ô∏è Dashboard page not found. Check file name or path.");
    })
    .catch(() => alert("‚ö†Ô∏è Unable to reach dashboard page."));
}
</script>
</body>
</html>
